# 代码清理规则

> **版本**: 1.5.0  
> **最后更新**: 2026-01-26

## 🧹 代码清理规则

**强制规则：定期识别并删除无用的代码、文档、脚本和配置文件，保持代码库整洁。**

### 需要清理的内容

1. **无用代码**：
   - 未使用的函数、类、模块
   - 注释掉的代码（除非有明确原因保留）
   - 过时的实现（已被新实现替代）
   - 调试代码（console.log、临时变量等）

2. **无用文档**：
   - 已解决的问题相关文档
   - 过时的配置说明
   - 重复的文档（已合并到其他文档）
   - 临时记录文档

3. **无用脚本**：
   - 无法正常工作的脚本
   - 已被替代的脚本
   - 仅包含提示信息的脚本（应合并到文档）

4. **无用配置**：
   - 未使用的 npm 脚本
   - 未使用的依赖（需要确认）
   - 过时的配置文件

### 清理流程

1. **识别无用内容**：
   - 使用 `grep` 搜索引用
   - 检查 `package.json` 中的脚本是否被使用
   - 检查导入/导出是否被引用
   - 检查文档是否还有价值

2. **确认无用性**：
   - 搜索整个代码库确认无引用
   - 检查 git 历史确认是否最近使用
   - 确认是否有计划使用

3. **安全删除**：
   - 先备份或提交到 git（如果重要）
   - 删除无用文件
   - 更新相关引用
   - 更新文档索引

4. **清理检查清单**：
   - [ ] 已搜索所有引用
   - [ ] 已确认无其他依赖
   - [ ] 已更新相关文档
   - [ ] 已更新 package.json（如果是脚本）
   - [ ] 已提交到 git

### 清理时机

1. **重构时**：
   - 重构后删除旧实现
   - 合并重复代码后删除重复部分

2. **功能完成后**：
   - 删除临时测试代码
   - 删除调试代码
   - 清理临时文档

3. **定期清理**：
   - 在规划阶段识别无用内容
   - 在代码审查时检查
   - 在文档更新时清理过时文档

### 清理原则

1. **谨慎删除**：
   - 不确定时先注释或标记为废弃
   - 重要代码先备份
   - 保留 git 历史以便恢复

2. **渐进式清理**：
   - 先标记为废弃
   - 逐步迁移引用
   - 最后删除

3. **保持一致性**：
   - 删除代码时同步更新文档
   - 删除文档时同步更新索引
   - 删除脚本时同步更新 package.json

### 示例

**识别无用脚本**：
```bash
# 检查脚本是否被引用
grep -r "test_domain.js" .
# 检查 package.json 中是否使用
grep "test_domain" package.json
# 如果都没有引用，可以删除
```

**识别无用代码**：
```typescript
// 搜索函数引用
grep -r "oldFunction" src/
// 如果没有引用，可以删除
```

**识别无用文档**：
```bash
# 检查文档是否被引用
grep -r "OLD_DOC.md" docs/
# 如果文档内容已合并到其他文档，可以删除
```
