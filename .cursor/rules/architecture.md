# 架构相关规则

> **版本**: 1.5.0  
> **最后更新**: 2026-01-26

## 📚 架构文档

**重要：项目架构的详细内容请查看 `docs/ARCHITECTURE.md`，本文件只包含架构相关的规则和注意事项。**

## 🔄 架构文档更新规则

**强制规则：架构文档须实时更新，不依赖用户提醒。** 任何架构相关代码变更都必须**在同一轮工作中**同步更新 `docs/ARCHITECTURE.md`（含架构图、分层图、接口、IPC、状态机、文件路径等），禁止先改代码、等用户提醒后再补文档。

### 必须更新的场景

1. **接口变更**（新增/修改/删除）
   - 更新第3章（核心接口与数据结构）
   - 更新相关使用示例
   - 更新接口注释

2. **数据结构变更**
   - 更新第4章（数据结构定义）
   - 更新相关接口说明

3. **IPC通信变更**
   - 更新第5章（IPC通信设计）
   - 更新IPC消息通道列表
   - 更新通信示例

4. **文件变更**（新增/重命名/移动）
   - 更新第12.2节（文件路径参考）
   - 更新文件行数统计

5. **架构变更**（新增模块/重构）
   - 更新第2章（整体分层架构）
   - 更新架构图
   - 更新层间通信机制

### 更新检查

在完成代码修改的**同一轮工作中**，必须立即：
- [ ] 判断本次变更是否影响架构文档（接口/数据结构/IPC/分层/状态机/文件等）
- [ ] 若有影响，当即更新 `docs/ARCHITECTURE.md` 相应章节与图表
- [ ] 使用文档中的更新检查清单（第13.3节）
- [ ] 更新"最后更新"日期
- [ ] 确保文档与代码一致

**不得**在未更新文档的情况下结束任务，也**不得**等用户提醒后再更新。
