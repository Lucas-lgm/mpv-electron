# 问题根本原因分析

## 当前情况

从日志看：
- ✅ 窗口句柄已获取：`1340055788736`
- ✅ 窗口句柄已传递给 MPV：`--wid=1340055788736`
- ❌ 但 MPV 仍然创建了独立窗口

## 根本原因

根据 MPV 官方文档和 macOS 系统限制：

**macOS 不允许跨进程窗口嵌入！**

这意味着：
- ❌ 不能通过 `spawn('mpv', ['--wid=...'])` 启动 MPV 并嵌入到 Electron 窗口
- ❌ `--wid` 参数只能在使用 `libmpv` 的**同一进程**内工作
- ❌ 从命令行启动的 MPV 进程无法访问其他进程的窗口

## 技术细节

```
Electron 进程 (Node.js)
    ↓
spawn('mpv', ['--wid=1234'])  ← 启动独立进程
    ↓
MPV 进程（独立进程，内存空间隔离）
    ↓
macOS 安全限制：不允许跨进程访问窗口句柄
    ↓
MPV 无法嵌入，创建独立窗口
```

## 解决方案

### 方案 1：使用 libmpv（真正嵌入）

需要在 Electron 主进程中直接使用 libmpv C 库：
- 需要编写 C++ addon
- 需要编译原生代码

### 方案 2：透明窗口同步（推荐）⭐⭐⭐⭐⭐

既然跨进程嵌入不可行，使用窗口同步方案：
- Electron 窗口透明，只显示控制面板
- MPV 使用独立窗口（性能最好）
- 两个窗口位置和大小同步

## 结论

**macOS 的系统限制导致无法通过命令行启动的 MPV 嵌入到 Electron 窗口。**

需要我实现窗口同步方案吗？这是最实用的解决方案。
