# Cursor AI 工作流使用示例

> **目的**: 提供实际使用示例，帮助理解如何应用工作流  
> **更新**: 发现更好的示例时请及时添加

## 📋 示例说明

每个示例包含：
- **场景**: 任务背景
- **提示词**: 使用的提示词
- **AI 响应**: AI 的规划（简化版）
- **执行**: 确认执行后的结果
- **总结**: 经验教训

---

## 示例 1：添加快捷键功能

### 场景
用户想要添加快捷键功能：空格键暂停/播放，左右箭头快进/快退。

### 提示词
```
【规划模式】我想添加快捷键功能：
- 空格键：暂停/播放
- 左箭头：快退 5 秒
- 右箭头：快进 5 秒

请先分析 @VideoView.vue 和 @ipcHandlers.ts，
然后制定实现计划。只提供计划，不要修改代码。
```

### AI 响应（规划阶段）
```
## 实现计划

### 涉及的文件
- `src/renderer/src/views/VideoView.vue` - 添加键盘事件监听
- `src/main/ipcHandlers.ts` - 添加 IPC 处理（如果需要）
- `src/preload/preload.ts` - 添加 IPC 通道（如果需要）

### 实现步骤
1. 在 VideoView.vue 中添加键盘事件监听器
2. 处理键盘事件，调用现有的 IPC 方法
3. 测试快捷键功能

### 注意事项
- 确保快捷键不会与系统快捷键冲突
- 只在视频窗口聚焦时响应

等待确认后执行。
```

### 用户反馈
```
计划很好，但我想先只实现空格键暂停/播放功能。
请更新计划。
```

### AI 更新计划
```
## 更新后的实现计划

### 涉及的文件
- `src/renderer/src/views/VideoView.vue` - 添加空格键监听

### 实现步骤
1. 在 VideoView.vue 的 mounted 钩子中添加键盘事件监听
2. 监听空格键，调用现有的播放/暂停 IPC 方法
3. 在 beforeUnmount 中移除监听器

等待确认后执行。
```

### 执行
```
用户：好的，开始实现吧。

AI：[开始修改代码]
```

### 总结
- ✅ 分阶段实现，先实现核心功能
- ✅ 根据反馈调整计划
- ✅ 明确确认后再执行

---

## 示例 2：修复播放列表 Bug

### 场景
播放列表在切换视频时有时会清空。

### 提示词
```
【规划模式】播放列表在切换视频时有时会清空。

问题表现：
- 打开多个视频文件
- 切换到另一个视频
- 播放列表突然清空

请先分析 @videoPlayerApp.ts 和 @ipcHandlers.ts，
找出问题原因并给出修复计划。
```

### AI 响应（规划阶段）
```
## 问题分析

### 可能的原因
1. 在 `ipcHandlers.ts` 的 `play-video` 处理中，播放列表更新逻辑有问题
2. 状态同步问题，导致播放列表被意外清空

### 需要检查的文件
- `src/main/videoPlayerApp.ts` - 播放列表管理
- `src/main/ipcHandlers.ts` - IPC 处理逻辑

### 修复计划
1. 检查 `play-video` IPC 处理中的播放列表更新逻辑
2. 确保播放列表状态正确同步
3. 添加日志帮助调试
4. 修复后测试切换视频的场景

等待确认后执行。
```

### 执行
```
用户：开始修复。

AI：[分析代码，找出问题，实施修复]
```

### 总结
- ✅ 先分析问题原因
- ✅ 提供修复计划
- ✅ 包含测试方案

---

## 示例 3：理解代码流程

### 场景
想理解视频播放的完整流程。

### 提示词
```
请追踪视频播放的完整执行流程。

从用户点击"播放"按钮开始，追踪到视频开始播放。

涉及的文件：
- @MainView.vue
- @ipcHandlers.ts
- @corePlayer.ts
- @libmpv.ts

请详细说明每个步骤。
```

### AI 响应
```
## 视频播放流程

### 1. 用户交互（renderer）
- MainView.vue 中用户点击播放按钮
- 调用 `window.electronAPI.playVideo()`

### 2. IPC 通信（preload → main）
- preload.ts 通过 `ipcRenderer.invoke('play-video')` 发送消息
- main 进程的 ipcHandlers.ts 接收消息

### 3. 播放控制（main）
- ipcHandlers.ts 调用 corePlayer.play()
- corePlayer 通过 libmpv 控制器执行播放

### 4. 状态更新
- 播放状态通过事件系统更新
- UI 通过 IPC 接收状态更新

[详细说明...]
```

### 总结
- ✅ 使用代码追踪理解复杂流程
- ✅ 引用多个相关文件
- ✅ 分步骤说明

---

## 示例 4：重构 IPC 处理

### 场景
ipcHandlers.ts 文件太大，想重构为多个模块。

### 提示词
```
【规划模式】我想重构 ipcHandlers.ts，将其拆分为多个模块。

当前问题：
- 文件太大（200+ 行）
- 所有 IPC 处理都在一个文件中
- 难以维护

目标：
- 按功能模块拆分
- 提高可维护性
- 保持现有功能不变

请先分析 @ipcHandlers.ts，然后制定重构计划。
```

### AI 响应（规划阶段）
```
## 重构计划

### 新的文件结构
- `src/main/ipc/handlers/fileHandlers.ts` - 文件相关 IPC
- `src/main/ipc/handlers/playbackHandlers.ts` - 播放控制 IPC
- `src/main/ipc/handlers/windowHandlers.ts` - 窗口相关 IPC
- `src/main/ipc/index.ts` - 统一导出

### 重构步骤
1. 创建新的目录结构
2. 按功能拆分现有代码
3. 更新导入导出
4. 测试确保功能正常

### 风险评估
- 低风险：主要是代码重组，不改变逻辑
- 需要仔细测试所有 IPC 功能

等待确认后执行。
```

### 执行
```
用户：计划很好，开始重构。

AI：[按计划执行重构]
```

### 总结
- ✅ 明确重构目标
- ✅ 提供详细的重构步骤
- ✅ 评估风险

---

## 💡 最佳实践总结

### 1. 明确需求
- 详细描述需求
- 说明期望的结果
- 提供足够的上下文

### 2. 使用模板
- 选择合适的模板
- 根据实际情况调整
- 保持一致性

### 3. 分阶段执行
- 复杂任务分阶段
- 每阶段确认后再继续
- 及时调整计划

### 4. 及时反馈
- 对计划提出疑问
- 要求调整计划
- 明确确认执行

### 5. 持续改进
- 记录好的实践
- 更新模板和文档
- 分享经验

---

## 🔄 更新记录

### 2026-01-25
- 初始版本
- 包含 4 个示例

### [未来更新]
- [添加新的示例]
